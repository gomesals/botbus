{"version":3,"sources":["../../src/js/paths.js"],"names":["angular","module","controller","pathsCtrl","pathsFormCtrl","$http","vm","get","then","data","r","handleError","remove","index","indexOf","item","delete","_id","status","splice","saving","neighborhoods","id","window","location","pathname","split","setTimeout","edit","selected","clear","confirm","confirmed","save","title","method","url","e","console","log","$inject"],"mappings":"aACA,CAAC,UAAW,CACX,aACAA,QAAQC,MAAR,CAAe,QAAf,CAAyB,CAAC,iBAAD,CAAzB,EAA8CC,UAA9C,CAAyD,WAAzD,CAAsEC,SAAtE,EAAiFD,UAAjF,CAA4F,eAA5F,CAA6GE,aAA7G,EAEA,QAASD,UAAT,CAAmBE,KAAnB,CAA0B,CACzB,GAAMC,IAAK,IAAX,CACAD,MAAME,GAAN,CAAU,WAAV,EAAuBC,IAAvB,CAA4B,WAAK,CAChCF,GAAGG,IAAH,CAAUC,EAAED,IACZ,CAFD,CAEGE,WAFH,EAGAL,GAAGM,MAAH,CAAY,cAAQ,CACnB,GAAMC,OAAQP,GAAGG,IAAH,CAAQK,OAAR,CAAgBC,IAAhB,CAAd,CACAV,MAAMW,MAAN,cAA0BV,GAAGG,IAAH,CAAQI,KAAR,EAAeI,GAAzC,EAAgDT,IAAhD,CAAqD,WAAK,CACzD,GAAIE,EAAEQ,MAAF,GAAa,GAAjB,CAAsB,CACrBZ,GAAGG,IAAH,CAAQU,MAAR,CAAeN,KAAf,CAAsB,CAAtB,CACA,CACD,CAJD,CAIGF,WAJH,CAKA,CACD,CAED,QAASP,cAAT,CAAuBC,KAAvB,CAA8B,CAC7B,GAAMC,IAAK,IAAX,CACAA,GAAGc,MAAH,CAAY,KAAZ,CACAd,GAAGG,IAAH,CAAU,EAAV,CACAJ,MAAME,GAAN,CAAU,mBAAV,EAA+BC,IAA/B,CAAoC,WAAK,CACxCF,GAAGe,aAAH,CAAmBX,EAAED,IACrB,CAFD,CAEGE,WAFH,EAGA,GAAMW,IAAKC,OAAOC,QAAP,CAAgBC,QAAhB,CAAyBC,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,CAAX,CACAC,WAAW,UAAM,CAChB,GAAIrB,GAAGsB,IAAP,CAAa,CACZvB,MAAME,GAAN,cAAuBe,EAAvB,EAA6Bd,IAA7B,CAAkC,WAAK,CACtCF,GAAGG,IAAH,CAAUC,EAAED,IAAZ,CACAH,GAAGuB,QAAH,CAAcnB,EAAED,IAAF,CAAOY,aACrB,CAHD,CAGGV,WAHH,CAIA,CACD,CAPD,CAOG,GAPH,EAQAL,GAAGwB,KAAH,CAAW,UAAM,CAChBxB,GAAGuB,QAAH,CAAc,EACd,CAFD,CAGAvB,GAAGyB,OAAH,CAAa,UAAM,CAClBzB,GAAG0B,SAAH,CAAe,KACf,CAFD,CAGA1B,GAAG2B,IAAH,CAAU,UAAM,CACf3B,GAAGc,MAAH,CAAY,IAAZ,CACA,GAAMX,MAAO,CACZyB,MAAO5B,GAAG4B,KADE,CAEZb,cAAef,GAAGuB,QAFN,CAAb,CAIAxB,MAAM,CACL8B,OAAS7B,GAAGsB,IAAH,CAAU,KAAV,CAAkB,MADtB,CAELQ,IAAM9B,GAAGsB,IAAH,cAAuBN,EAAvB,CAA8B,WAF/B,CAGLb,SAHK,CAAN,EAIGD,IAJH,CAIQ,WAAK,CACZe,OAAOC,QAAP,CAAkB,iBAClB,CAND,CAMG,WAAK,CACPlB,GAAGc,MAAH,CAAY,KAAZ,CACAT,YAAY0B,CAAZ,CACA,CATD,CAUA,CACD,CAED,QAAS1B,YAAT,CAAqB0B,CAArB,CAAwB,CACvBC,QAAQC,GAAR,CAAYF,CAAZ,CACA,CACDlC,UAAUqC,OAAV,CAAoB,CAAC,OAAD,CAApB,CACApC,cAAcoC,OAAd,CAAwB,CAAC,OAAD,CACxB,CAjED","file":"paths.js","sourcesContent":["/*global angular*/\n(function() {\n\t'use strict';\n\tangular.module('botbus', ['checklist-model']).controller('pathsCtrl', pathsCtrl).controller('pathsFormCtrl', pathsFormCtrl);\n\n\tfunction pathsCtrl($http) {\n\t\tconst vm = this;\n\t\t$http.get('api/paths').then(r => {\n\t\t\tvm.data = r.data;\n\t\t}, handleError);\n\t\tvm.remove = item => {\n\t\t\tconst index = vm.data.indexOf(item);\n\t\t\t$http.delete(`api/paths/${vm.data[index]._id}`).then(r => {\n\t\t\t\tif (r.status === 200) {\n\t\t\t\t\tvm.data.splice(index, 1);\n\t\t\t\t}\n\t\t\t}, handleError);\n\t\t};\n\t}\n\n\tfunction pathsFormCtrl($http) {\n\t\tconst vm = this;\n\t\tvm.saving = false;\n\t\tvm.data = {};\n\t\t$http.get('api/neighborhoods').then(r => {\n\t\t\tvm.neighborhoods = r.data;\n\t\t}, handleError);\n\t\tconst id = window.location.pathname.split('/')[3];\n\t\tsetTimeout(() => {\n\t\t\tif (vm.edit) {\n\t\t\t\t$http.get(`api/paths/${id}`).then(r => {\n\t\t\t\t\tvm.data = r.data;\n\t\t\t\t\tvm.selected = r.data.neighborhoods;\n\t\t\t\t}, handleError);\n\t\t\t}\n\t\t}, 100);\n\t\tvm.clear = () => {\n\t\t\tvm.selected = [];\n\t\t};\n\t\tvm.confirm = () => {\n\t\t\tvm.confirmed = false;\n\t\t}\n\t\tvm.save = () => {\n\t\t\tvm.saving = true;\n\t\t\tconst data = {\n\t\t\t\ttitle: vm.title,\n\t\t\t\tneighborhoods: vm.selected,\n\t\t\t};\n\t\t\t$http({\n\t\t\t\tmethod: (vm.edit ? 'PUT' : 'POST'),\n\t\t\t\turl: (vm.edit ? `api/paths/${id}` : 'api/paths'),\n\t\t\t\tdata,\n\t\t\t}).then(r => {\n\t\t\t\twindow.location = 'painel/trajetos';\n\t\t\t}, e => {\n\t\t\t\tvm.saving = false;\n\t\t\t\thandleError(e);\n\t\t\t});\n\t\t};\n\t}\n\n\tfunction handleError(e) {\n\t\tconsole.log(e);\n\t}\n\tpathsCtrl.$inject = ['$http'];\n\tpathsFormCtrl.$inject = ['$http'];\n})();\n"]}