{"version":3,"sources":["../../src/js/prices.js"],"names":["angular","module","controller","pricesCtrl","pricesFormCtrl","$http","vm","get","then","data","r","map","price","split","handleError","remove","index","indexOf","item","delete","_id","status","splice","id","window","location","pathname","saving","setTimeout","edit","save","method","url","e","console","log","$inject"],"mappings":"aACA,CAAC,UAAW,CACX,aACAA,QACEC,MADF,CACS,QADT,EAEEC,UAFF,CAEa,YAFb,CAE2BC,UAF3B,EAGED,UAHF,CAGa,gBAHb,CAG+BE,cAH/B,EAKA,QAASD,WAAT,CAAoBE,KAApB,CAA2B,CAC1B,GAAMC,IAAK,IAAX,CAEAD,MAAME,GAAN,CAAU,YAAV,EAAwBC,IAAxB,CAA6B,WAAK,CACjCF,GAAGG,IAAH,CAAUC,EAAED,IAAF,CAAOE,GAAP,CAAW,eAAS,CAC7BC,MAAMA,KAAN,CAAcA,MAAMA,KAAN,CAAYC,KAAZ,CAAkB,IAAlB,CAAd,CACA,MAAOD,MACP,CAHS,CAIV,CALD,CAKGE,WALH,EAOAR,GAAGS,MAAH,CAAY,cAAQ,CACnB,GAAMC,OAAQV,GAAGG,IAAH,CAAQQ,OAAR,CAAgBC,IAAhB,CAAd,CACAb,MAAMc,MAAN,eAA2Bb,GAAGG,IAAH,CAAQO,KAAR,EAAeI,GAA1C,EAAiDZ,IAAjD,CAAsD,WAAK,CAC1D,GAAIE,EAAEW,MAAF,GAAa,GAAjB,CAAsB,CACrBf,GAAGG,IAAH,CAAQa,MAAR,CAAeN,KAAf,CAAsB,CAAtB,CACA,CACD,CAJD,CAIGF,WAJH,CAKA,CACD,CAED,QAASV,eAAT,CAAwBC,KAAxB,CAA+B,CAC9B,GAAMC,IAAK,IAAX,CACA,GAAMiB,IAAKC,OAAOC,QAAP,CAAgBC,QAAhB,CAAyBb,KAAzB,CAA+B,GAA/B,EAAoC,CAApC,CAAX,CAEAP,GAAGqB,MAAH,CAAY,KAAZ,CACArB,GAAGG,IAAH,CAAU,EAAV,CAEAmB,WAAW,UAAM,CAChB,GAAItB,GAAGuB,IAAP,CAAa,CACZxB,MAAME,GAAN,eAAwBgB,EAAxB,EAA8Bf,IAA9B,CAAmC,WAAK,CACvCF,GAAGG,IAAH,CAAUC,EAAED,IACZ,CAFD,CAEGK,WAFH,CAGA,CACD,CAND,CAMG,GANH,EAQAR,GAAGwB,IAAH,CAAU,UAAM,CACfxB,GAAGqB,MAAH,CAAY,IAAZ,CACAtB,MAAM,CACL0B,OAASzB,GAAGuB,IAAH,CAAU,KAAV,CAAkB,MADtB,CAELG,IAAM1B,GAAGuB,IAAH,eAAwBN,EAAxB,CAA+B,YAFhC,CAGLd,KAAMH,GAAGG,IAHJ,CAAN,EAIGD,IAJH,CAIQ,WAAK,CACZgB,OAAOC,QAAP,CAAkB,gBAClB,CAND,CAMG,WAAK,CACPnB,GAAGqB,MAAH,CAAY,KAAZ,CACAb,YAAYmB,CAAZ,CACA,CATD,CAUA,CACD,CAED,QAASnB,YAAT,CAAqBmB,CAArB,CAAwB,CACvBC,QAAQC,GAAR,CAAYF,CAAZ,CACA,CAED9B,WAAWiC,OAAX,CAAqB,CAAC,OAAD,CAArB,CACAhC,eAAegC,OAAf,CAAyB,CAAC,OAAD,CACzB,CA/DD","file":"prices.js","sourcesContent":["/*global angular*/\n(function() {\n\t'use strict';\n\tangular\n\t\t.module('botbus')\n\t\t.controller('pricesCtrl', pricesCtrl)\n\t\t.controller('pricesFormCtrl', pricesFormCtrl);\n\n\tfunction pricesCtrl($http) {\n\t\tconst vm = this;\n\n\t\t$http.get('api/prices').then(r => {\n\t\t\tvm.data = r.data.map(price => {\n\t\t\t\tprice.price = price.price.split('\\n');\n\t\t\t\treturn price;\n\t\t\t});\n\t\t}, handleError);\n\n\t\tvm.remove = item => {\n\t\t\tconst index = vm.data.indexOf(item);\n\t\t\t$http.delete(`api/prices/${vm.data[index]._id}`).then(r => {\n\t\t\t\tif (r.status === 200) {\n\t\t\t\t\tvm.data.splice(index, 1);\n\t\t\t\t}\n\t\t\t}, handleError);\n\t\t};\n\t}\n\n\tfunction pricesFormCtrl($http) {\n\t\tconst vm = this;\n\t\tconst id = window.location.pathname.split('/')[3];\n\n\t\tvm.saving = false;\n\t\tvm.data = {};\n\n\t\tsetTimeout(() => {\n\t\t\tif (vm.edit) {\n\t\t\t\t$http.get(`api/prices/${id}`).then(r => {\n\t\t\t\t\tvm.data = r.data;\n\t\t\t\t}, handleError);\n\t\t\t}\n\t\t}, 100);\n\n\t\tvm.save = () => {\n\t\t\tvm.saving = true;\n\t\t\t$http({\n\t\t\t\tmethod: (vm.edit ? 'PUT' : 'POST'),\n\t\t\t\turl: (vm.edit ? `api/prices/${id}` : 'api/prices'),\n\t\t\t\tdata: vm.data,\n\t\t\t}).then(r => {\n\t\t\t\twindow.location = 'painel/tarifas';\n\t\t\t}, e => {\n\t\t\t\tvm.saving = false;\n\t\t\t\thandleError(e);\n\t\t\t});\n\t\t};\n\t}\n\n\tfunction handleError(e) {\n\t\tconsole.log(e);\n\t}\n\n\tpricesCtrl.$inject = ['$http'];\n\tpricesFormCtrl.$inject = ['$http'];\n})();\n"]}